<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI Kundtjänst</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://kit.fontawesome.com/a2d9d5b5f5.js" crossorigin="anonymous"></script>
</head>

<body data-theme="dark">
  <div class="app">

    <!-- AUTH -->
    <section id="authScreen" class="authScreen">
      <div class="authCard">
        <div class="authBrand">
          <div class="logo">AI</div>
          <div>
            <h1>AI Kundtjänst</h1>
            <p>Logga in för att fortsätta</p>
          </div>
        </div>

        <div class="authInputs">
          <label>Användarnamn</label>
          <input id="username" type="text" placeholder="ex: pilav" autocomplete="username" />

          <label>Lösenord</label>
          <input id="password" type="password" placeholder="••••••••" autocomplete="current-password" />

          <div id="authMessage" class="authMessage"></div>

          <div class="authButtons">
            <button id="loginBtn" class="btn primary">
              <i class="fas fa-right-to-bracket"></i> Logga in
            </button>
            <button id="registerBtn" class="btn ghost">
              <i class="fas fa-user-plus"></i> Registrera
            </button>
          </div>

          <div class="authHint">
            <i class="fas fa-shield"></i>
            Din data sparas per konto.
          </div>
        </div>
      </div>
    </section>

    <!-- MAIN APP -->
    <section id="mainApp" class="mainApp" style="display:none;">

      <!-- SIDEBAR -->
      <aside class="sidebar">
        <div class="sidebarTop">
          <div class="sideBrand">
            <div class="logo small">AI</div>
            <div>
              <div class="sideTitle">Kundtjänst</div>
              <div class="sideSub">Tickets + AI</div>
            </div>
          </div>

          <div class="sideBlock">
            <div class="sideLabel">Kategori</div>
            <select id="companySelect" class="select">
              <option value="demo">Demo AB</option>
              <option value="law">Juridik</option>
              <option value="tech">Teknisk support</option>
              <option value="cleaning">Städservice</option>
            </select>
          </div>

          <div class="sideNav">
            <button id="navTickets" class="navItem active">
              <i class="fas fa-ticket"></i> Ärenden
            </button>

            <button id="navChat" class="navItem">
              <i class="fas fa-comments"></i> Chatt
            </button>

            <button id="navKb" class="navItem" style="display:none;">
              <i class="fas fa-database"></i> Kunskapsdatabas
              <span class="chip">Admin</span>
            </button>
          </div>
        </div>

        <div class="sidebarBottom">
          <button id="themeToggle" class="btn ghost full">
            <i class="fas fa-moon"></i> Växla tema
          </button>

          <button id="logoutBtn" class="btn danger full">
            <i class="fas fa-sign-out-alt"></i> Logga ut
          </button>

          <div class="tiny">AI Kundtjänst • Render</div>
        </div>
      </aside>

      <!-- CONTENT -->
      <main class="content">

        <!-- TOPBAR -->
        <div class="topbar">
          <div class="titleBlock">
            <div class="title" id="title">AI Kundtjänst</div>
            <div class="subtitle" id="subtitle"></div>
          </div>

          <div class="actions">
            <button id="clearChat" class="btn ghost">
              <i class="fas fa-trash"></i> Rensa
            </button>

            <button id="exportChat" class="btn ghost">
              <i class="fas fa-download"></i> Export
            </button>
          </div>
        </div>

        <!-- TICKETS VIEW -->
        <section id="ticketsView" class="view">
          <div class="ticketsCard">
            <div class="ticketsHeader">
              <div>
                <h2>Ärenden</h2>
                <p class="muted">Klicka ett ärende för att öppna chatten</p>
              </div>

              <button id="ticketsReloadBtn" class="btn ghost">
                <i class="fas fa-sync"></i> Uppdatera
              </button>
            </div>

            <div class="ticketsGrid">
              <div class="ticketsCol">
                <h3>Mina ärenden</h3>
                <div id="ticketsMine" class="ticketsList"></div>
              </div>

              <div class="ticketsCol" id="ticketsAdminBox" style="display:none;">
                <h3>Alla ärenden (Admin)</h3>
                <div id="ticketsAdmin" class="ticketsList"></div>
              </div>
            </div>
          </div>
        </section>

        <!-- CHAT VIEW -->
        <section id="chatView" class="view" style="display:none;">
          <div class="chatCard">
            <div id="messages" class="messages"></div>

            <div class="composer">
              <div class="composerBox">
                <input id="messageInput" type="text" placeholder="Skriv ditt meddelande..." />
                <button id="sendBtn" class="btn primary">
                  <i class="fas fa-paper-plane"></i> Skicka
                </button>
              </div>
              <div id="ragBadge" class="ragBadge" style="display:none;"></div>

              <!-- ✅ Agent takeover (admin) -->
              <div id="agentPanel" class="agentPanel" style="display:none;">
                <div class="agentTitle"><i class="fas fa-headset"></i> Agent takeover</div>
                <div class="agentRow">
                  <input id="agentInput" placeholder="Svara som agent..." />
                  <button id="agentSendBtn" class="btn danger">
                    <i class="fas fa-paper-plane"></i> Skicka
                  </button>
                </div>
                <div class="mutedTiny">Tip: agent-svar hamnar i ärendet som “agent”.</div>
              </div>
            </div>
          </div>
        </section>

        <!-- KB VIEW (ADMIN) -->
        <section id="kbView" class="view" style="display:none;">
          <div class="kbCard">
            <div class="kbHeader">
              <div>
                <h2 id="kbTitle">Kunskapsdatabas</h2>
                <p class="muted">Ladda upp Text/URL. PDF kommer i nästa version.</p>
              </div>

              <div class="kbHeaderActions">
                <button id="kbReloadBtn" class="btn ghost">
                  <i class="fas fa-sync"></i> Uppdatera
                </button>
                <button id="kbExportCategoryBtn" class="btn ghost">
                  <i class="fas fa-file-export"></i> Exportera kategori
                </button>
                <button id="kbExportAllBtn" class="btn danger">
                  <i class="fas fa-shield-alt"></i> Export ALLT
                </button>
              </div>
            </div>

            <div class="kbGrid">
              <div class="kbBox">
                <div class="kbBoxTitle"><i class="fas fa-link"></i> URL</div>
                <input id="kbUrlInput" placeholder="https://..." />
                <button id="kbUploadUrlBtn" class="btn primary full">Spara URL</button>
              </div>

              <div class="kbBox">
                <div class="kbBoxTitle"><i class="fas fa-align-left"></i> Text</div>
                <textarea id="kbTextInput" rows="6" placeholder="Klistra in text..."></textarea>
                <button id="kbUploadTextBtn" class="btn primary full">Ladda upp text</button>
              </div>
            </div>

            <div id="kbMsg" class="kbMsg"></div>

            <h3 style="margin-top:18px;">Källor i kategori</h3>
            <div id="kbList" class="kbList"></div>
          </div>
        </section>

      </main>
    </section>
  </div>

  <script src="script.js"></script>
</body>
</html>
